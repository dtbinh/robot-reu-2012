#!/usr/bin/env python
import roslib; roslib.load_manifest('irobot_mudd')
import rospy
import rospy.impl.tcpros
import sys
from socket import *
import SharedData


def openTCPconnection():
    """Opens a TCP connection to a TCP server."""
    
    serverHost = 'localhost'
    #serverHost = '192.168.1.101'
    serverHost = '134.173.195.75'

    serverPort = 2008
    
    s = socket(AF_INET, SOCK_STREAM)     #Create a TCP socket
    s.connect((serverHost, serverPort))  #Connect to server on the port
    
    if SharedData.state == "stop":
        message = "stop"
    else:
        message = "go"
    
    while True:
    
        s.send(message) #send the data 
        data = s.recv(1024) #receive up to 1K bytes 
        print "I received the message:", data
    
        #if message == 'quit': # to quit the server, too
        #    break
    
        #if message == 'q': # just quits the client
        #    break
        
        #message = raw_input("Type a string to send: ")
        if data == "stop":
            SharedData.myState = "stop"
        

    
    print 'Good bye!'


if __name__ == "__main__":
    openTCPconnection()

